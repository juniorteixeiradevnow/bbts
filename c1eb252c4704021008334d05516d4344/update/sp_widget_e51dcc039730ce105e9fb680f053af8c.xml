<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function($scope) {

  /* widget controller */
  var c = this;
	
	c.data.pergunta1 = "";
	c.data.pergunta2 = "";
	c.data.pergunta3 = "";
	
	
	var url = location.href;
	var regex = /acesskey=([^&]*)/;
	var match = url.match(regex);
	if (match) {
		var key = match[1];
		c.data.acesskey = key;
		$scope.server.update();
	}
	
	
c.renderWidget = function (){
		if(c.data.render){
			return true
		}
}
	
c.renderError = function (){
		if(c.data.erro){
			return true
		}
}
	
	
	//Submit do form
	c.onSubmit = function(){
		//TODO
		c.data.action = "onSubmit"
		c.data.nome = $scope.c.data.name;
		c.data.email = $scope.c.data.name
		c.data.pergunta1 = $scope.c.data.pergunta1
		c.data.pergunta2 = $scope.c.data.pergunta2
		c.data.pergunta3 = $scope.c.data.pergunta3
		$scope.server.update();
		
		
		
		setTimeout(function (){
			location.reload();
		},3000)
	}

};]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>formulario_perguntas_adicionais</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Formulario perguntas adicionais</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
	/* populate the 'data' object */
	/* e.g., data.table = $sp.getValue('table'); */
	
	if(input){
		var gr = new GlideRecord('x_1174267_case_b_0_candidatos')
		gr.addEncodedQuery('chave_de_acesso=' + input.acesskey + '^perguntas_respondidas=nao');
		gr.query();
		if(gr.next()){
			data.render = true;
			data.nome = gr.getDisplayValue('nome');
			data.email = gr.getDisplayValue('email');
			
		} else {
			data.erro = true;
		}
		
		
	}
	
	if(input){
		if(input.action == "onSubmit"){
			var gr2 = new GlideRecord('x_1174267_case_b_0_candidatos')
			gr2.addEncodedQuery('chave_de_acesso=' + input.acesskey + '^perguntas_respondidas=nao');
			gr2.query();
			if(gr2.next()){
				gr2.pergunta_adicional_1 = input.pergunta1;
				gr2.pergunta_adicional_2 = input.pergunta2;
				gr2.pergunta_adicional_3 = input.pergunta3;
				gr2.perguntas_respondidas = "sim";
				gr2.update();
				
				gs.addInfoMessage("Perguntas Enviadas com sucesso!");
				
			}
		}
	}

})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-03-11 19:53:44</sys_created_on>
        <sys_id>e51dcc039730ce105e9fb680f053af8c</sys_id>
        <sys_mod_count>165</sys_mod_count>
        <sys_name>Formulario perguntas adicionais</sys_name>
        <sys_package display_value="Case Banco Brasil Tecnologia" source="x_1174267_case_b_0">c1eb252c4704021008334d05516d4344</sys_package>
        <sys_policy/>
        <sys_scope display_value="Case Banco Brasil Tecnologia">c1eb252c4704021008334d05516d4344</sys_scope>
        <sys_update_name>sp_widget_e51dcc039730ce105e9fb680f053af8c</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-03-29 00:54:26</sys_updated_on>
        <template><![CDATA[
<div class="container mx-auto" ng-if="c.renderWidget()">
  <div class="rounded-sm">
    <div class="row g-2">
      <div class="col-md-4 mx-auto d-block">
        <img src="x_1174267_case_b_0.illustration.png" height="200px" class="mx-auto d-block">
      </div>
      
      <div class="col-md-8">
        <div class="card-body">
          <h4 class="card-title">Formulário de Perguntas Adicionais</h4>
          <h5>Verifique se seus dados estão corretos</h5> 
          <form>
            
         
          
          <div class="mb-3">
            <label for="formGroupExampleInput" class="form-label">Nome:</label>
            <input type="text" name="nome" class="form-control" id="formGroupExampleInput" disabled ng-model="c.data.nome">
          </div>
          <div class="mb-3">
            <label for="formGroupExampleInput2" class="form-label">Email</label>
            <input type="text" class="form-control" id="formGroupExampleInput2" disabled ng-model="c.data.email">
          </div>
          <div class="mb-3">
            <label for="formGroupExampleInput2" class="form-label">Qual sua expectativa salarial?</label>
            <input type="text" class="form-control" id="formGroupExampleInput2" required ng-model="c.data.pergunta1">
          </div>
          <div class="mb-3">
            <label for="formGroupExampleInput2" class="form-label">Fale de um projeto importante em que trabalhou?</label>
            <input type="text" class="form-control" id="formGroupExampleInput2" required ng-model="c.data.pergunta2">
          </div>
          <div class="mb-3">
            <label for="formGroupExampleInput2" class="form-label">Porque você deseja trabalhar na Tech hire?</label>
            <textarea class="form-control" id="textAreaExample" rows="3" placeholder="Add a message here" required ng-model="c.data.pergunta3"></textarea>
          </div>
          <br />
          <div class="mb-3">
            <button class="btn" ng-click="c.onSubmit()">
              Enviar!
            </button>
          </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  
</div>
<div style="display:flex; justify-content:center; align-items:center;" ng-if="c.renderError()">
  <h4>
    Você já respondeu esse formulário!
  </h4>
</div>


]]></template>
    </sp_widget>
</record_update>
