<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function($scope) {
  /* widget controller */
  var c = this;
	
	
	var url = location.href;
	var regex = /acesskey=([^&]*)/;
	var match = url.match(regex);
	if (match) {
		var key = match[1];
		c.data.acesskey = key;
		$scope.server.update();
	} else {
		data.formJaRespondido = true;
	}
	
	
	c.data.novaData = "";
	
	c.approve = function (){
		c.data.action = "submit";
		c.data.novaData = $scope.data.novaData;
		$scope.server.update();
		
		setTimeout(function (){
			location.reload();
		},2000);
	}
	
	c.changeValue = function (){
		c.data.novaData = $scope.data.novaData;
		
	}
	
};]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>data_da_entrevista</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Confirmação data da entrevista</name>
        <option_schema/>
        <public>true</public>
        <roles/>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */

	
	if(input){
	var gr = new GlideRecord('x_1174267_case_b_0_candidatos')
		gr.addEncodedQuery('chave_de_acesso=' + input.acesskey + '^perguntas_respondidas=sim^status=entrevista_pessoal');
		gr.query();
		if(gr.next()){
			data.formNaoRespondido = true;
			data.nome = gr.getDisplayValue('nome');
			data.datadantrevista = gr.getDisplayValue('data_da_entrevista');
		} else {
			data.formJaRespondido = true;
		}
		
		if(input.action){
			
			var gr2 = new GlideRecord('x_1174267_case_b_0_candidatos')
			gr2.addEncodedQuery('chave_de_acesso=' + input.acesskey + '^perguntas_respondidas=sim');
			gr2.query();
			if(gr2.next()){
				
				if(input.action == "submit"){
					
					gr2.setValue("status", "data_da_entrevista_agendada");
					gr2.setValue("data_da_entrevista", input.novaData);
					gs.addInfoMessage("Nova data Confirmada com sucesso!");
					gr2.update();
				}
				
				if(input.action == "cancel"){
					gr2.setValue("status", "entrevista_cancelada");
					gs.addInfoMessage("Entrevista Confirmada com sucesso!");
					gr2.update();
				}
			}
		}
		
	}
	
	
	
	
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-04-01 00:07:06</sys_created_on>
        <sys_id>1ce64465c395021029107405e40131d0</sys_id>
        <sys_mod_count>75</sys_mod_count>
        <sys_name>Confirmação data da entrevista</sys_name>
        <sys_package display_value="Case Banco Brasil Tecnologia" source="x_1174267_case_b_0">c1eb252c4704021008334d05516d4344</sys_package>
        <sys_policy/>
        <sys_scope display_value="Case Banco Brasil Tecnologia">c1eb252c4704021008334d05516d4344</sys_scope>
        <sys_update_name>sp_widget_1ce64465c395021029107405e40131d0</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-04-05 12:55:58</sys_updated_on>
        <template><![CDATA[

<div id="container" ng-if="c.data.formNaoRespondido">
  
<nav class="navbar navbar-expand-lg navbar-light">
  <p class="navbar-brand">
    Tech Hire
  </p>
</nav>
  
<div class="container mt-5">
  <h2 class="text-center">Solicitar nova Data da Entrevista</h2>
  <div class="row mt-3">
    <div class="col text-center">
      <h2>
        Olá, {{data.nome}}
      </h2>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col text-center">
      <h4>
        Visto que você não pode comparecer na data:<b>{{data.datadantrevista}}</b> marcada, escolha uma nova data abaixo.
      </h4>
    </div>
  </div>
  <div class="row mt-3 justify-content-center"  style="display: flex; flex-direction:column; justify-content:center; align-items:center;">
    <div class="col text-center">
      
      <div class="input-group date mb-2">
        <input id="datetimepicker1" data-format="YYYY-MM-DD hh:mm:ss" type="text" class="form-control input-lg w-25" ng-model="c.data.novaData" ng-change="c.changeValue()"></input>
        <span class="input-group-addon">
          <i class="fa fa-calendar"></i>
        </span>
     </div>
     <h3>
       <p ng-if="data.novaData !== ''">Nova Data: {{c.data.novaData}}</p>
      </h3>
    <br>
      <button id="cancelar" class="btn btn-primary mr-2" ng-click="c.approve()">Solicitar nova data</button>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(function() {
    $('#datetimepicker1').datetimepicker({
      format: 'YYYY-MM-DD HH:mm:ss',
      language: 'en'
    });
  });
</script>
</div>
<div id="error" ng-if="c.data.formJaRespondido" class="row mt-3">
  <div class="col text-center">
  <h2>
    Você já respondeu este formulário, ou nem tem permissão acessa-lo!
  </h2>
  </div>
</div>
]]></template>
    </sp_widget>
</record_update>
